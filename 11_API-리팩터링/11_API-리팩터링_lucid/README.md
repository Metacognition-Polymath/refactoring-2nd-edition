# API 리펙토링

## Intro
- 좋은 API 를 개선하는 방법을 새로 깨달을 때마다 그에 맞게 리팩터링 해야한다.
- 섞여있을경우 질의함수와 변경함수 분리하기를 적용해 갈라놔야된다
- 어떤 매개변수는 그저 함수의 동작모드를 전환하는 용도로만쓰일때 => 플래그 인수 제거하기
- 필요이상으로 분해될때 객체 통째로넘기기

## 11.1 질의 함수와 변경 함수 분리하기

### 배경
- 우리는 외부에서 관찰할 수 있는 겉보기 부수효과가 전혀없이 반환해주는 함수를 추구해야 한다
- side Effect 를 만들지말자
### 절차
1) 대상 함수를 복제하고 질의 목적에 충실한 이름을 짓는다.
2) 새 질의 함수에서 부수효과를 모두 제거한다.
3) 정적검사를 수행한다
4) 원래 함수를 호출하는곳을 모두 찾아낸다. 질의 함수를 호출하는 코드를 바로 아래줄에 새로 추가, 하나 수정할때마다 테스트한다.
5) 원래 함수에서 즬이 관련 코드를 제거한다.
6) 테스트한다.
                 
## 11.2 함수 매개변수화하기
- 두 함수의 로직이 아주 비슷하고 단지 리터럴 값만 다르다면, 그 다른 값만 매개변수로 처리로 중복없앨수 있다.

### 절차
1) 비슷한 함수 중 하나를 선택한다
2) 함수 선언 바꾸기로 리터럴들을 매개변수로 추가한다.
3) 이 함수를 호출하느 곳 모두에 적절한 리터럴 값을 추가한다.
4) 테스트한다.
5) 매개변수로 받은 갑승ㄹ 사용하도록 함수 본문을 수정한다. 하나 수정할때마다 테스트한다.
6) 비슷한 다른 함수호출 코드를 찾아 매개변수화된 함수를 호출하도록 하나씩 수정한다. 하나 수정할때마다 테스트한다.

## 11.3 플래그 인수 제거하기

### 배경
- 플래그 인수란 호출되는 함수가 실행할 로직을 호출하는쪽에서 선택하기 위해 전달하는 인수다. 다음 함수를 보자
~~~javascript

    function bookConcert(aCustomer, isPremium) {
      if (isPremium){
	    // 프리미엄 예약용 로직		
      } else{
		// 일반 예약용 로직
      }
    }
	const CostomerType = {
	  PREMIUM: false
    }
	
	bookConcert({}, true);
    bookConcert({}, CostomerType.PREMIUM)
    bookConcert({}, 'premium')

// 호출할때 어려울수 잇으니 플래그를 하지말자, 무의미하다
~~~
### 절차
- 매개변수로 주어질 수 잇는 값 각각에 대응하는 명시적 함수들을 생성한다.
- 원래 함수를 호출하는 코드들을 모두 찾아서 각 리터럴 값에 대응하는 명시적 함수를 호출하도록 수정한다.

                    
## 11.4 객체통째로 넘기기

### 배경 
- 하나의 레코드에서 값 두어개를 가져와 인수로 나머지는 코드를 보면, 그 값들 대신 레코드를 통째로 넘기고 함수 본문에서 필요한 값들을 꺼내 쓰도록 수정하곤한다.
- 한 객체가 제공하는 기능 중 항상 또ㅓ깥은 일부만을 사용하는 코다가 많다면 그 기능을 따로 묵어서 클래스로 추찰하기도한다.
- 객체의 메서드를 호출하면서 호출하는 객체 자신이 가지고 있는 데이터 여거개를 건낸느 경우다. 이런 상황이면 객체 자신을 참조하게 this 로 바꾸자

### 절차
- 매개변수들을 원하는 형태로 받는 빈 함수를 만든다.
- 새 함수의 본문에서는 원래 함수호출, 새 매개변수와 원래 함수의 매개변수를 매핑한다
- 정적 검사 수행한다
- 모든 호출자가 새 함수를 사용하게 수정한다. 하나씩 수정하며 테스트하자
- 호출자를 모두 수정했다면 원래 함수를 인라인 한다
